<!DOCTYPE html>
<html>
<head>
    <title>Landing Page</title>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
</head>
<body>
    <h1>Bem vindos !!!</h1>
    <!-- Video player for rotation -->
    <video id="landing-video" width="640" height="360" controls autoplay muted>
        <source id="video-source" src="{{ url_for('static', filename='videos/' + videos[0]) }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <br>
    <button id="goto-dashboard" style="font-size:2em;">Ir para o Painel</button>
    <script>
        // ==== Video Gallery ====
        var videos = {{ videos|tojson }};
        var currentVideoIdx = 0;
        var $video = $('#landing-video');
        var $videoSource = $('#video-source');
        $video.on('ended', function() {
            currentVideoIdx = (currentVideoIdx + 1) % videos.length;
            $videoSource.attr('src', '/static/videos/' + videos[currentVideoIdx]);
            $video[0].load();
            $video[0].play();
        });

        // ==== Navigation and Usage Logging ====
        $('#goto-dashboard').on('click touchstart', function() {
            $.post('/api/log-interaction', JSON.stringify({
                action: 'go_to_dashboard',
                ts: new Date().toISOString()
            }), null, 'json');
            window.location.href = '/dashboard';
        });

        // Log landing page visits
        $(function(){
            $.post('/api/log-interaction', JSON.stringify({
                action: 'visit_landing',
                ts: new Date().toISOString()
            }), null, 'json');
        });
    </script>
</body>
</html>